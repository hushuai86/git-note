<attachment contenteditable="false" data-atts="%5B%5D" data-aid=".atts-9d56d6e5-62cd-49be-8690-66ac90b6551b"></attachment><h1>K8s 基本命令K8s 基本命令</h1><p><span style="color: rgb(255, 0, 0); background-color: rgb(255, 255, 204);">注意：</span></p><p><span style="background-color: rgb(255, 255, 204);">在Ocean STG 环境 执行K8S 命令前，需要先进入&nbsp;</span><span style="color: rgb(255, 0, 0); background-color: rgb(255, 255, 204);">192.168.66.91:22</span><span style="background-color: rgb(255, 255, 204);">，运行</span><strong style="color: rgb(255, 0, 0); background-color: rgb(255, 255, 204);">&nbsp;cat set_kube_env.sh</strong><span style="background-color: rgb(255, 255, 204);"> ，然后复制并运行&nbsp;set_kube_env.sh 中的命令。</span></p><p><span style="background-color: rgb(255, 255, 204);">在Ocean Prod 环境 执行K8S 命令前，需要先进入&nbsp;</span><span style="color: rgb(255, 0, 0); background-color: rgb(255, 255, 204);">10.120.22.100:22</span><span style="background-color: rgb(255, 255, 204);">，运行</span><strong style="color: rgb(255, 0, 0); background-color: rgb(255, 255, 204);">&nbsp;cat set_kube_env.sh</strong><span style="background-color: rgb(255, 255, 204);"> ，然后复制并运行&nbsp;set_kube_env.sh 中的命令。</span></p><p><br></p><p><br></p><p>#查询所有的namespace&nbsp;</p><pre class="ql-syntax" spellcheck="false">kubectl get ns
</pre><p><br></p><p>#Ocean 这边主要用到的是 Ocean-infra 和 Ocean-operator-protal 俩个namespace</p><p>#其中 Ocean-infra namespace 主要部署了 elasticsearch,eqmx,kafa,redis,zookeeper</p><p>#Ocean-operator-protal namespace 部署了Ocean 的所有project</p><p><br></p><p>#查询所有的 Node&nbsp;</p><pre class="ql-syntax" spellcheck="false">kubectl -n ocean-infra-staging get node
</pre><p><br></p><p>#显示Node的详细信息,ocean-dockeree-ucp-01 是 Node Name</p><pre class="ql-syntax" spellcheck="false">kubectl describe node ocean-dockeree-ucp-01
</pre><p><br></p><p>#查询指定namespace下所有的 pod</p><pre class="ql-syntax" spellcheck="false">kubectl -n ocean-infra-staging get pod&nbsp;&nbsp;&nbsp;
</pre><p><br></p><p><br></p><p>#显示Pod的详细信息,kafka-0 是pod Name</p><pre class="ql-syntax" spellcheck="false">kubectl&nbsp;-n ocean-infra-staging describe kafka-0
</pre><p><br></p><p>#查询指定namespace下所有的 service</p><pre class="ql-syntax" spellcheck="false">kubectl -n ocean-infra-staging get service
</pre><p><br></p><p>#查询指定namespace下某个 pod 的全部日志，加&nbsp;-f 查看实时日志， 其中&nbsp;alert-service-54456b8dd5-h4f4k 是 pod Name</p><pre class="ql-syntax" spellcheck="false">kubectl -n&nbsp;ocean-operator-portal-staging logs&nbsp;alert-service-54456b8dd5-h4f4k
</pre><p><br></p><p>#删除指定namespace下的指定pod,一般在yaml中配置了自动重新创建pod，所以删除pod相当于重启pod</p><pre class="ql-syntax" spellcheck="false">kubectl -n ocean-operator-portal-staging&nbsp; delete pod&nbsp;&nbsp;alert-service-54456b8dd5-h4f4k
</pre><p><br></p><p>#进入Pod容器,kafka-0 是pod Name</p><pre class="ql-syntax" spellcheck="false">kubectl -n&nbsp;ocean-infra-staging exec -it kafka-0 bash
</pre><p><br></p><p>#在容器内可以通过serviceName.namespace:端口号&nbsp;访问指定的service</p><p>#例如 进入kafka-0 容器后，先需要修改JMX的端口 export JMX_PORT=8888,</p><p>#然后我需要访问 zookeeper 来查询所有的topic</p><pre class="ql-syntax" spellcheck="false">kafka-topics.sh --list--zookeeper zookeeper.ocean-infra-staging:2181
</pre><p><br></p><p>#端口映射，供外部访问</p><pre class="ql-syntax" spellcheck="false">kubectl -n&nbsp;ocean-infra-staging port-forward&nbsp;zookeeper-0&nbsp;2181:2181
</pre><p><br></p><p>#基于现有的service创建NodePort的 service</p><p>kubectl -n ocean&nbsp;&nbsp;expose svc kafka-connect-sink --name=temp-connect-sink&nbsp;&nbsp;--type=NodePort</p><p>kubectl -n ocean-operator-portal-staging expose svc kafka-producer --name=temp-kafka-producer&nbsp;--type=NodePort</p><p><br></p><p>kubectl -n ocean-infra-staging expose svc&nbsp;kafka --name=temp-kafka-nodeport&nbsp;--type=NodePort</p><p><br></p><p>#当某个pod迟迟无法创建时，用命令查看它的描述信息</p><p>kubectl describe pod XXXX</p><p><br></p><p>#查看创建的Replication Controller</p><p>kubectl get rc</p><p><br></p>