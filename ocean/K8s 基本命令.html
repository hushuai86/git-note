<attachment contenteditable="false" data-atts="%5B%5D" data-aid=".atts-9d56d6e5-62cd-49be-8690-66ac90b6551b"></attachment><h1>K8s 基本命令K8s 基本命令</h1><p><span style="color: rgb(255, 0, 0); background-color: rgb(255, 255, 204);">注意：</span></p><p><span style="background-color: rgb(255, 255, 204);">在Ocean STG 环境 执行K8S 命令前，需要先进入&nbsp;</span><span style="color: rgb(255, 0, 0); background-color: rgb(255, 255, 204);">192.168.66.91:22</span><span style="background-color: rgb(255, 255, 204);">，运行</span><strong style="color: rgb(255, 0, 0); background-color: rgb(255, 255, 204);">&nbsp;cat set_kube_env.sh</strong><span style="background-color: rgb(255, 255, 204);"> ，然后复制并运行&nbsp;set_kube_env.sh 中的命令。</span></p><p><span style="background-color: rgb(255, 255, 204);">在Ocean Prod 环境 执行K8S 命令前，需要先进入&nbsp;</span><span style="color: rgb(255, 0, 0); background-color: rgb(255, 255, 204);">10.120.22.100:22</span><span style="background-color: rgb(255, 255, 204);">，运行</span><strong style="color: rgb(255, 0, 0); background-color: rgb(255, 255, 204);">&nbsp;cat set_kube_env.sh</strong><span style="background-color: rgb(255, 255, 204);"> ，然后复制并运行&nbsp;set_kube_env.sh 中的命令。</span></p><p><br></p><p><br></p><pre class="ql-syntax" spellcheck="false">#查询所有的namespace&nbsp;
kubectl get ns

#Ocean 这边主要用到的是 Ocean-infra 和 Ocean-operator-protal 俩个namespace
#其中 Ocean-infra namespace 主要部署了 elasticsearch,eqmx,kafa,redis,zookeeper
#Ocean-operator-protal namespace 部署了Ocean 的所有project

#查询所有的 Node&nbsp;
kubectl -n ocean-infra-staging get node

#显示Node的详细信息,ocean-dockeree-ucp-01 是 Node Name
kubectl describe node ocean-dockeree-ucp-01

#查询指定namespace下所有的 pod
kubectl -n ocean-infra-staging get pod&nbsp;&nbsp;&nbsp;


#显示Pod的详细信息,kafka-0 是pod Name
kubectl&nbsp;-n ocean-infra-staging describe kafka-0

#查询指定namespace下所有的 service
kubectl -n ocean-infra-staging get service

#查询指定namespace下某个 pod 的全部日志，加&nbsp;-f 查看实时日志， 其中&nbsp;alert-service-54456b8dd5-h4f4k 是 pod Name
kubectl -n&nbsp;ocean-operator-portal-staging logs&nbsp;alert-service-54456b8dd5-h4f4k

#删除指定namespace下的指定pod,一般在yaml中配置了自动重新创建pod，所以删除pod相当于重启pod
kubectl -n ocean-operator-portal-staging&nbsp; delete pod&nbsp;&nbsp;alert-service-54456b8dd5-h4f4k

#进入Pod容器,kafka-0 是pod Name
kubectl -n&nbsp;ocean-infra-staging exec -it kafka-0 bash

#在容器内可以通过serviceName.namespace:端口号&nbsp;访问指定的service
#例如 进入kafka-0 容器后，先需要修改JMX的端口 export JMX_PORT=8888,
#然后我需要访问 zookeeper 来查询所有的topic
kafka-topics.sh --list--zookeeper zookeeper.ocean-infra-staging:2181

#端口映射，供外部访问
kubectl -n&nbsp;ocean-infra-staging port-forward&nbsp;zookeeper-0&nbsp;2181:2181

#基于现有的service创建NodePort的 service
kubectl -n ocean&nbsp;&nbsp;expose svc kafka-connect-sink --name=temp-connect-sink&nbsp;&nbsp;--type=NodePort
kubectl -n ocean-operator-portal-staging expose svc kafka-producer --name=temp-kafka-producer&nbsp;--type=NodePort

kubectl -n ocean-infra-staging expose svc&nbsp;kafka --name=temp-kafka-nodeport&nbsp;--type=NodePort

#当某个pod迟迟无法创建时，用命令查看它的描述信息
kubectl describe pod XXXX

#查看创建的Replication Controller
kubectl get rc
</pre><p><br></p>