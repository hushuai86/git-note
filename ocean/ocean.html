<attachment contenteditable="false" data-atts="%5B%5D" data-aid=".atts-cb1ab902-0d83-46a7-b0d4-7233b7223d29"></attachment><h1>一. Sentinel&nbsp;环境搭建</h1><h2><br></h2><h3>1.下载</h3><pre class="ql-syntax" spellcheck="false">https://github.com/microsoftarchive/redis/releases/tag/win-3.2.100
</pre><p><br></p><p><strong style="color: rgb(255, 70, 53);">一般主从三个节点可以配置三个对应的sentinel，这里为了方便，我只部署一个sentinel</strong></p><h3>2.将解压后的文件夹拷贝四份，分别重命名为</h3><pre class="ql-syntax" spellcheck="false">redis-master
redis-slave1
redis-slave2
redis-sentinel
</pre><p><br></p><h3>3.修改配置文件</h3><p>将redis-master 添加到环境变量 Path中</p><p>修改redis-slave1 目录下的&nbsp;redis.windows-service.conf</p><p>#修改默认端口</p><p>port = 6380</p><p>#添加 主从关系</p><p>slaveof 127.0.0.1 6379</p><p><br></p><p>3.修改redis-slave2 目录下的 redis.windows-service.conf</p><p>#修改默认端口</p><p>port = 6381</p><p>#添加 主从关系</p><p>slaveof 127.0.0.1 6379</p><h3><br></h3><h3>4.将redis-sentinel 目录下的&nbsp;redis.windows-service.conf 重名为 sentinel.conf,并修改配置</h3><p>#修改默认端口</p><p>port 26379</p><p>#配置sentinel</p><p>sentinel myid 2925817e77ce0ab656c682a2b8ac671aeecd7b2d</p><p>sentinel monitor master 127.0.0.1 6379 1</p><p>sentinel down-after-milliseconds master 5000</p><p>sentinel config-epoch master 28</p><p><br></p><p><br></p><h3>4.生成windows Service&nbsp;</h3><p>进入 redis-master 目录并执行</p><p>redis-server --service-install redis.windows-service.conf --loglevel verbose --service-name redis-master</p><p><br></p><p>进入 redis-slave1目录并执行</p><p>redis-server --service-install redis.windows-service.conf --loglevel verbose --service-name redis-slave1</p><p><br></p><p>进入 redis-slave2目录并执行</p><p>redis-server --service-install redis.windows-service.conf --loglevel verbose&nbsp;--service-name&nbsp;redis-slave2</p><p><br></p><p>进入 redis-sentinel目录并执行</p><p>redis-server --service-install sentinel.conf --sentinel --service-name redis-sentinel</p><p><br></p><h3>5.打开windows 服务管理，启动所有的Redis Service&nbsp;</h3><p><br></p><h1><br></h1><h1><strong>二. 常用命令</strong></h1><p><br></p><p>Sentinel 命令</p><p>#打开 sentinel 命令管理</p><p>redis-cli -h localhost -p 26379</p><p><br></p><p>#列出所有被监视的主服务器，以及这些主服务器的当前状态</p><p>SENTINEL masters</p><p><br></p><p>#列出给定主服务器的所有从服务器，以及这些从服务器的当前状态。</p><p>SENTINEL slaves &lt;master name&gt;</p><p><br></p><p>#手动 主从切换</p><p>sentinel failover master</p><p><br></p><p>查看当前节点主从信息</p><p>info replication</p><p><br></p><p><span style="color: rgb(51, 51, 51);">将当前服务器转变为指定服务器的从属服务器</span></p><p>Redis Slaveof</p><p><br></p><p>批量删除key</p><p>redis-cli --no-auth-warning -a&nbsp;&nbsp;password keys *_telemetry | xargs redis-cli --no-auth-warning -a&nbsp;&nbsp;password del</p><p><br></p>