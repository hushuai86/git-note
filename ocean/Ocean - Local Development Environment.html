<attachment contenteditable="false" data-atts="%5B%5D" data-aid=".atts-656514a1-4bb2-47b4-a8d4-fd630c26992e"></attachment><h1>Ocean - Local Development EnvironmentOcean - Local Development Environment</h1><p> <strong style="color: unset;">一．&nbsp;&nbsp;&nbsp;&nbsp;Development Environment</strong></p><p><br></p><p>Jdk11 (openJdk 14以下版本编译 redis-connect 不通过,建议用SE版本)</p><p>Node.js</p><p>Yarn</p><p>Git</p><p>Maven</p><p>SSH Client (Xshell ,secureCRT, putty and so on)</p><p>IDE (IDEA ,Eclipse and so on)</p><p><br></p><p>#The following can use the environment on other servers by modifying the configuration file</p><p>Kafak &amp; Zookeeper</p><p>Redis Sentiel</p><p>Cassandar&nbsp;&nbsp;&nbsp;</p><p>Mysql 5.7</p><p><br></p><p><strong>二． Development&nbsp;&nbsp;&nbsp;</strong></p><p><br></p><p>1.&nbsp;&nbsp;&nbsp;&nbsp;Clone develop branch code</p><p>git clone –b develop http://192.168.130.91:5790/nttca/ocean/ocean</p><p><br></p><p>#外网地址</p><p>git clone -b develop http://14.23.109.92.5791/nttca/ocean/ocean</p><p><br></p><p>2.&nbsp;&nbsp;&nbsp;&nbsp;Import Ocean Project into your IDE</p><p><br></p><p>3.&nbsp;&nbsp;&nbsp;&nbsp;Install maven dependencies</p><p>#Execute the following Maven command under the “ocean/” directory</p><p>mvn clean install –DskipTests</p><p><br></p><p>4.&nbsp;&nbsp;&nbsp;&nbsp;Perform the following steps If you use Kafka, Redis, Cassandra and MySQL in your local environment</p><p>1). Start kafka,Redis,Cassandra and Mysql</p><p>2). Run the <strong>kafka.bat</strong> script to create the necessary topics in kafka (need to modify the kafka Installation path in the script)</p><p>3). Open the cqlsh command box and execute the CQL statement in the <strong>init-Cql.sh</strong> to initialize the Cassandra database</p><p>4). Create "ocean" database in MySQL and execute flyway cmd under ocean-db-migration project to initialize ocean DB.</p><p><strong>4.1) update the jdbc path in pom.xml which in the&nbsp;&nbsp;ocean-db-migration project to Connect your MySql DB</strong></p><p><strong>4.2) rum maven cmd&nbsp;</strong>&nbsp;"<strong>mvn flyway:migrate" under&nbsp;ocean-db-migration project</strong></p><p><a href="about:blank" target="_blank"><img src="//:0" alt="kafka.bat"></a></p><p><a href="about:blank" target="_blank"><img src="//:0" alt="init-Cql.sh"></a></p><p><br></p><p><br></p><p>5.&nbsp;&nbsp;&nbsp;&nbsp;Modify the application.properties File, mainly to modify the configuration of MySQL, Kafka, Cassandra and redis.</p><p><br></p><p>6.&nbsp;&nbsp;&nbsp;&nbsp;If you only need to visit the page and do not need to send and receive telemetry and alarm, you only need to start the following items</p><p><br></p><p>alert-service</p><p>device-service</p><p>map-service</p><p>auditlog-service</p><p>ui-service</p><p>ocean-ui</p><p>#ocean-ui is a Vue project, you need to run "yarn install" command&nbsp;to install all dependencies and then run&nbsp;“yarn serve” command to start the project</p><p><br></p><p>7.&nbsp;&nbsp;&nbsp;&nbsp;If you need to send and receive new alarms and telemetries, and let the charts on the page update automatically, then start the following items based on the above</p><p>kafka-producer</p><p>Ocean-stream-service</p><p>Access <span style="color: rgb(255, 70, 53);">localhost:4000</span> after&nbsp;<span style="color: rgb(51, 51, 51); background-color: rgb(251, 250, 248);">kafka-producer</span> successful startup to enter the swagger UI page and execute its API to send Kafka messages.</p><p>Because the previous data is cleared every time Kafka is restarted, the producerDeviceFromFile API needs to be executed once to send the message of the devices,&nbsp;</p><p>and then the producerAlarmFromFile and producerTelemetryFromFile API are executed to send messages regularly.&nbsp;</p><p>The parameters of these&nbsp;APIs are <span style="color: rgb(255, 0, 0);">filePath,delay and size,format</span></p><p><span style="color: rgb(255, 0, 0);">filePath :&nbsp;The path of the excel file which contains the data you want to send</span></p><p><a href="about:blank" target="_blank" style="color: rgb(255, 0, 0);"><img src="//:0" alt="test.xlsx"></a></p><p><span style="color: rgb(255, 0, 0);">delay :&nbsp;Interval time between sending,The unit is millisecond,If delay = 0, it is sent only once.</span></p><p><span style="color: rgb(255, 0, 0);">size :&nbsp;Number of messages sent each time, if&nbsp;size =0 ,all messages in the Excel will be sent.</span></p><p><span style="color: rgb(255, 0, 0);">format : send message to kafka</span> <span style="color: rgb(255, 0, 0);">if&nbsp;format =0</span> <span style="color: rgb(255, 0, 0);">and send message to Mqtt&nbsp;if format =1</span></p><p>&nbsp;You can control how many pieces of data are sent every few milliseconds, and executing the cancel API can stop the scheduled task</p><p><br></p><p>8.if you want to send Email when received new Alarm or&nbsp;the alarm status is updated ,you need to start the following items based on the above</p><p>email-service&nbsp;</p><p><br></p><p>9. If you need to synchronize messages from devices topic to MySQL or telemetry to Cassandra, you need to start Kafka sink connectors</p><p>(1) If you wantto update the device table data in the Mysql DB by sending Kafka message of devices, you need to start kafka-mysql-connector and send devices message</p><p>(2) If you want to display the latest telemetry value at the device detail page&nbsp;of the device module , you need to start kafka-redis-connector and send telemetry message.</p><p>(3) If you want to display the line chart of the last telemetry page of the device module, you need to run the ocean-stream-service and start the kafka-cassandra-connector and send telemetry messages regularly</p><p><br></p>